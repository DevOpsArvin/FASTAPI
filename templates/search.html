<!DOCTYPE html>
<html>
<head>
    <title>Search Page</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="apple-mobile-web-app-capable" content="yes">
        
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
    
    <link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
    <link rel="stylesheet" type="text/css" href="/static/style.css">

   <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>

<!--

    <script>
        // Disable browser back keys
        history.pushState(null, null, location.href);
        window.onpopstate = function () {
            history.go(1);
        };
    </script>


-->


</head>
<body>
    <div class="container">
        <h1>Search Page</h1>
        
        {% if loginU_var %}
        <p>Logged in as: {{ loginU_var }}</p>
        <input type="hidden" name="loginU_var" value="{{ loginU_var }}">
        {% endif %}

        <form method="POST" action="/search">
            <div class="form-group">
                <label for="station">Search Station:</label>
                <input type="text" id="station" name="station" required class="form-control" {% if station %} value="{{ station }}" {% endif %}>
            </div>
            
            {% if loginU_var %}
            <input type="hidden" name="loginU_var" value="{{ loginU_var }}">
            {% endif %}

            <div class="form-group">
                <input type="submit" value="Search" class="btn btn-primary">
            </div>
        </form>

        {% if results %}
        <h2>Search Results</h2>
        <table class="table table-striped table-sm">
            <thead>
                <tr>
                    <th>Floor</th>                   
                    <th>Station</th>
                    <th>Port</th>
                    <th>Interface</th>
                    <th>Location</th>

                </tr>
            </thead>
            <tbody>
                {% for row in results %}
                <tr>
                    <td>
                        <a href="#" data-bs-toggle="modal" data-bs-target="#{{ row[4] }}{{ row[1] }}">{{ row[4] }}</a>
                    </td>
                    <td>{{ row[1] }}</td>
                    <td>{{ row[2] }}</td>
                    <td>{{ row[3] }}</td>                      
                    <td>{{ row[6] }}</td>
                </tr>


                <!-- Modal 1 TO PROCESS -->

                <div class="modal fade" id="{{ row[4] }}{{ row[1] }}" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="staticBackdropLabel" aria-hidden="true">
                  <div class="modal-dialog">
                    <div class="modal-content">
                      <div class="modal-header">
                        <h5 class="modal-title" id="staticBackdropLabel">To Process...</h5>
                        
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                      </div>

                      <div class="modal-body">
                            <p>{{ row[4] }} | {{ row[1] }}</p>
                            <p>{{ row[2] }} | {{ row[3] }}</p>
                            <p>{{ row[6] }}</p>
                            
                            <form method="POST">
                                <input type="hidden" name="floor" value="{{ row[4] }}">
                                <input type="hidden" name="station" value="{{ row[1] }}">
                                <input type="hidden" name="port" value="{{ row[2] }}">
                                <input type="hidden" name="interface" value="{{ row[3] }}">
                                <input type="hidden" name="loginU_var" value="{{ loginU_var }}">
         
                                <div class="modal-footer">
                                    
                                    <button type="submit" class="btn btn-primary" formaction="/process_modal_form1" style="float: Right;">Clear Port</button>
                                    
                                    
                                    <button class="btn btn-primary" type="button" data-bs-toggle="modal" data-bs-target="#{{ row[2] }}{{ row[3] }}" aria-expanded="false" aria-controls="change_Vlan">Change VLAN</button>

                                    <button class="btn btn-primary" type="button" data-bs-toggle="modal" data-bs-target="#change_Voice" aria-expanded="false" aria-controls="change_Voice">Change Voice</button>
                                    


                                    <button type="submit" class="btn btn-primary" formaction="/process_modal_form3">xChange Voice</button>

                                    

                                    

                                </div>

                            </form>
                      </div>

                    </div>
                  </div>
                </div>




                <!-- Modal 2 VLAN -->

                <div class="modal fade" id="{{ row[2] }}{{ row[3] }}" data-bs-backdrop="static" data-bs-keyboard="false"  aria-labelledby="staticBackdropLabel" aria-hidden="true">
                  <div class="modal-dialog">
                    <div class="modal-content">
                      <div class="modal-header">
                        <h5 class="modal-title" id="staticBackdropLabel">To Process...</h5>
                        
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                      </div>
                      <div class="modal-body">
                            <p>{{ row[4] }} | {{ row[1] }}</p>
                            <p>{{ row[2] }} | {{ row[3] }}</p>

                            <form method="POST">
                                <input type="text" name="floor" value="{{ row[4] }}">
                                <input type="text" name="station" value="{{ row[1] }}">
                                <input type="text" name="port" value="{{ row[2] }}">
                                <input type="text" name="interface" value="{{ row[3] }}">
                                <input type="text" name="loginU_var" value="{{ loginU_var }}">

                                <div class="card card-body">
                                <div class="form-floating">
                                  {% if resultsVLAN %}  

                                  <select class="form-select" id="select_Vlan" aria-label="Floating label select example">
                                    <!--
                                    <option selected>Select VLAN</option>
                                    -->
                                    
                                    
                                    {% for row in resultsVLAN %}
                                        <option value="{{ row[1] }}">{{row[1]}} - {{row[2]}}</option>
                                    {% endfor %}
                                  </select>

                                  {% endif %}
                                  <label for="select_Vlan">Select VLAN</label>
                                  
                                  <input type="text" id="VlanCustom" name="VlanCustom" class="form-control" >
                                </div>
                              </div>

                                <button type="submit" class="btn btn-primary" formaction="/process_modal_form2">Change VLAN</button>

                            </form>
                      </div>

                    </div>
                  </div>
                </div>



                <!-- Modal 2 VOICE -->

                <div class="modal fade" id="change_Voice" data-bs-backdrop="static" data-bs-keyboard="false"  aria-labelledby="staticBackdropLabel" aria-hidden="true">
                  <div class="modal-dialog">
                    <div class="modal-content">
                      <div class="modal-header">
                        <h5 class="modal-title" id="staticBackdropLabel">Voice To Process...</h5>
                        
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                      </div>
                      <div class="modal-body">

                            <p>{{ row[2] }} | {{ row[3] }}</p>

                            <form method="POST">
                                <input type="hidden" name="station" value="{{ row[1] }}">
                                <input type="hidden" name="port" value="{{ row[2] }}">
                                <input type="hidden" name="loginU_var" value="{{ loginU_var }}">

                                <div class="card card-body">
                                <div class="form-floating">
                                  {% if resultsVoice %}  
                                  <select class="form-select" id="select_Voice" aria-label="Floating label select example">
                                    <option selected>Select Voice</option>
                                    {% for rowvc in resultsVoice %}
                                        <option value="{{ rowvc[1] }}">{{rowvc[1]}} - {{rowvc[2]}}</option>
                                    {% endfor %}
                                  </select>
                                  {% endif %}
                                  <label for="select_Voice">Select Voice</label>
                                  
                                  <input type="text" id="VoiceCustom" name="VoiceCustom" class="form-control" >
                                </div>
                              </div>

                                <button type="submit" class="btn btn-primary" formaction="/process_modal_form3">Change VLAN</button>

                            </form>
                      </div>

                    </div>
                  </div>
                </div>



                {% endfor %}





            </tbody>
        </table>
        {% endif %}
    </div>

    <script>
        $(document).ready(function() {
            $('#select_Vlan').change(function() {
                var selectedOption = $(this).val();
                $('#VlanCustom').val(selectedOption);
            });
        });
    </script>






    <script>
        $(document).ready(function() {
            $('#select_Vlan').change(function() {
                var selectedOption = $(this).val();
                if (selectedOption !== "000") {
                    $('#VlanCustom').prop('readonly', true);
                } else {
                    $('#VlanCustom').prop('readonly', false);
                }
            });
        });
    </script> 

<!--

-->
    <script>
        $(document).ready(function() {
            $('#select_Voice').change(function() {
                var selectedOption = $(this).val();
                $('#VoiceCustom').val(selectedOption);
            });
        });
    </script>

    <script>
        $(document).ready(function() {
            $('#select_Voice').change(function() {
                var selectedOption = $(this).val();
                if (selectedOption !== "000") {
                    $('#VoiceCustom').prop('readonly', true);
                } else {
                    $('#VoiceCustom').prop('readonly', false);
                }
            });
        });
    </script>







    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>




</body>
</html>
